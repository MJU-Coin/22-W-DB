# Chapter 06 데이터 모델링

# 01 데이터 모델링의 개념

## 1 데이터 베이스 생명주기

 데이터 베이스는 개선 또는 다시 구축되기도 한다. 데이터베이스의 생성과 운영에 관련된 특징을 데이터베이스 생명주기라고 한다. 아래의 다섯 과정을 돌고 돈다.

1. 요구사항 수집 및 분석 ; 데이터베이스 구축의 범위를 정하는 단계
2. 설계 ; 식별(개념적 설계), 변환(논리적 설계), 도출(물리적 설계)
3. 구현 ; DBMS에 적용하여 객체를 만들고, 서비스 제공 프로그램 완성
4. 운영 ; 서비스 제공
5. 감시 및 개선 ; 문제점 개선, 지속 운영을 위한 변경 및 유지 보수

## 2 데이터 모델링 과정

 데이터 모델링은 데이터베이스 생명주기 중 요구사항 수집 및 분석부터 설계까지의 과정을 말한다.

1. 요구사항 수집 및 분석 ; 현실 세계의 대상 및 사용자의 요구사항을 정리 및 분석
    
    첫 단계이므로, 앞으로의 진행 방향이 결정되기에 매우 중요하다.
    
    1. 실제 문서를 수집하고 분석
    2. 담당자와의 인터뷰나 설문조사를 통해 요구사항을 직접 수렴
    3. 비슷한 업무를 처리하는 기존의 데이터베이스를 분석
    4. 각 업무와 연관된 모든 부문을 살펴본다
2. 개념적 모델링 ; 중요 개념을 구분 (개념적 모델링)
    
    업무의 핵심적인 개념을 구분하고 전체적인 뼈대를 만드는 과정이다.
    
     핵심적인 개념을 구분 : 개체entity를 추출하고 각 개체들 간의 관계relation를 정의하여 ER 다이어그램 (ERD. Entity Relationship Diagram)을 만드는 과정.
    
    개체 : 구체적으로 표현할 수 있는 실체
    
    ER 다이어그램 :  실체들의 관계를 표현한 것
    
3. 논리적 모델링 ; 각 개념을 구체화 (논리적 모델링)
    
    개념적 모델링에서 만든 ER 다이어그램을 사용하고자 하는 DBMS에 맞게 사상(매핑mapping)하여 실제 데이터베이스로 구현하기 위한 모델을 만드는 과정이다.
    
    1. 개념적 모델링에서 추출하지 않았던 상세 속성들을 모두 추출
    2. 정규화를 수행
    3. 데이터의 표준화를 수행
4. 물리적 모델링 ; 데이터베이스 생성 계획에 따라 개체, 인덱스 등을 생성 (물리적 모델링)
    
    작성된 논리적 모델을 실제 컴퓨터의 저장 장치에 저장하기 위한 물리적 구조를 정의하고 구현하는 과정이다.
    
    물리적 모델링을 할 때 트랜잭션, 저장공간 설계 측면에서 고려할 사항.
    
    1. 응답시간을 최소화해야 한다
    2. 얼마나 많은 트랜잭션을 동시에 발생시킬 수 있는지 검토해야 한다
    3. 데이터가 저장될 공간을 효율적으로 배치해야 한다

# 02 ER 모델

ER 모델은 세상의 사물을 개체entity와 개체 간의 관계relationship로 표현한다. 개체는 독립적인 의미를 지니고 있는 유무형의 사람 또는 사물을 말하며, 개체의 특성을 나타내는 속성 attribute으로 식별한다. 또한 개체끼리는 서로 관계를 가진다. 이와 같이 개체 속성, 관계를 규명하는 것이 ER 모델의 기본이다.

## 1 개체와 개체 타입

개체entity : 사람, 사물, 장소, 개념, 사건과 같이 유무형의 정보를 가지고 있는 독립적인 실체. 비슷한 속성을 가진 개체 타입cntity type을 구성하며, 개체 집합entity set으로 묶인다.

개체 집합 : 공통된 속성을 가진 개체들의 모임

개체 타입 : 개체 집합의 이러한 동일한 특징을 나타내는 용어

### 개체 타입의 ER 다이어그램 표현

ER 다이어그램 상에서 개체 타입은 직사각형으로 나타낸다. 개체 타입은 보통 '개체'라고 부르는 강한 개체strong entity 타입과 약한 개체weak entity 타입으로 구분할 수 있다. 강한 개체 타입은 직사각형으로, 약한 개체 타입은 이중 직사각형으로 나타낸다. 개체 타입의 이름은 기호 중앙에 표기하며 일반적으로 단수형 명사를 사용한다.

### 개체 타입의 유형

강한 개체strong entity타입은 다른 개체의 도움 없이 독자적으로 존재할 수 있다. 반면 약한 개체weak entity 타입은 독자적으로는 존재할 수 없고 반드시 상위 개체 타입을 가진다.

## 2 속성

속성 attribute은 개체가 가진 성질을 말한다.

### 속성의 ER 다이어그램 표현

속성은 기본적으로 타원으로 표현하며 개체 타입을 나타내는 직사각형과 실선으로 연결된다. 속성의 이름은 타원의 중앙에 표기한다. 속성이 개체를 유일하게 식별할 수 있는 키일 경우 속성 이름에 밑줄을 긋는다. 속성은 키 속성과 일반 속성으로 표현된다.

### 속성의 유형

- 단순속성과 복합 속성
    
    단순 속성 simple attribute : 더 이상 분해가 불가능한 속성
    
    복합 속성composite attribute : 독립적인 의미를 가진 속성으로 분해할 수 있는 속성이다.
    
- 단일값 속성과 다중값 속성
    
    단일값 속성single-valued attribute : 하나의 값만을 가지는 속성
    
    다중값 속성 multi-valued attribute : 여러개의 값을 가지는 속성이다.
    
- 저장 속성과 유도 속성
    
    저장 속성Mored atribute : 다른 속성의 영향 없이 단독으로 저장되는 속성
    
    유도 속성derived attribute : 다른 저장 속성으로부터 유도된(계산되어진) 속성이다.
    

## 3 관계와 관계 타입

관계kelationship : 개체 사이의 연관성을 나타내는 개념

관계 타입relationship type : 개체 타입과 개체 타입 간의 연결 가능한 관계를 정의한 것

관계 집합relationshipset : 관계로 연결된 집합을 의미

### 관계 타입의 ER 다이어그램 표현

관계 타입은 마름모로 표현하며 관계 타입의 이름은 기호의 중앙에 표기한다. 속성을 가질 수 있다. 관계 타입의 속성은 이 관계가 어떠한 관계인지에 대한 추가적인 정보를 제공한다.

### 관계 타입의 유형

- 차수에 따른 유형 ; 관계 집합에 참가하는 개체 타입의 수를 관계 타입의 차수deasee 라고 한다. n진 관계로 표현한다
    - 1진 관계(recursive relationship)
    한 개의 개체가 자기 자신과 관계를 맺는 경우이다.
    - 2진 관계(binary relationship)
    두 개의 개체가 관계를 맺는 경우이다.
    - 3진 관계(ternary relationship)
    세 개의 개체가 관계를 맺는 경우다.
- 관계 대응 수에 따른 유형
    
    관계 대응 수cardinality : 두 개체 타입의 관계에 실제로 참여하는 개별 개체 수를 의미한다. 개체 타입과 관계 타입을 연결하는 실선 위에 표기하며, 하나만참여할 경우 1, 두 개 이상 다중으로 참여할 경우 N 혹은 M으로 표기한다
    
    - 일대일(1:1) 관계
    좌측 개체 타입에 포함된 개체가 우측 개체 타입에 포함된 개체와 일대일로 대응하는 관계이다.
    - 일대다(1:N), 다대일(N1) 관계
    일대다 혹은 다대일 관계는 실제 일상생활에서 가장 많이 볼 수 있는 관계로, 한쪽 개체 타입의 개체 하나가 다른 쪽 개체 타입의 여러 개체와 관계를 맺는 경우이다.
    - 다대다(MN) 관계
    각 개체 타입의 개체들이 서로 임의의 개수의 개체들과 서로 복합적인 관계를 맺고 있는 경우이다
- 관계 대응 수의 최솟값최댓값
    
    관계 대응 수 1:1, 1:N, M:N에서 1, M, N은 각 개체가 관계에 참여하는 최댓값을 의미한다. ER 다이어그램에서는 대응 수 외에 최솟값과 최댓값을 관계실선 위에(최솟값, 최댓값)으로 표기한다.
    

### ISA 관계

상위 개체 타입의 특성에 따라 하위 개체 타입이 결정되는 형태로 ISA 관계라고 한다. 이때 상위 개체 타입을 슈퍼클래스, 하위 개체 타입을 서브클래스라고 한다. ISA 관계는 역삼각형으로 표현하며 역삼각형 위에는 슈퍼클래스, 아래에는 각각의 서브클래스를 관계 실선으로 연결한다.

### 참여 제약 조건

개체 집합 내 모든 개체가 관계에 참여하는지 유무에 따라 전체 참여와 부분 참여로 구분할 수 있다.

전체 참여 : 개체집합의 모든 개체가 관계에 참여. 개체 타입
과 관계를 두 줄 실선으로 표현. 최솟값이 1 이상으로 모두 참여.

부분 참여 : 일부만 참여. 일반적인 관계 표현과 동일하게 단일 실선으로 표현. 최솟값이 0 이상.

### 역할

개체 타입 간의 관계를 표현할 때 각 개체들은 고유한 역할role을 담당한다. 일반적으로 역할은 관계만으로 알 수 있으면 생략한다. 그러나 관계에서 역할이 명확하지 않을 경우에는 반드시 표기해야 한다.

### 순환적 관계

순환적 관계recursive relationship : 하나의 개체 타입이 동일한 개체 타입(자기 자신)과 순환적으로 관계를 가지는 형태를 말한다. 관계선을 개체 타입과 관계 타입 양쪽에 두개를 그린다.

## 4 약한 개체 타입과 식별자

강한 개체strong entity 타입 : 독립적으로 식별할 수 있는 개체를 가지고 있는 개체 타입. 각 개체를 식별할 수 있는 기본키를 가진다.

약한 개체weak entity 타입 : 상위 개체 타입이 결정되지 않으면 개별 개체를 식별할 수 없는 종속된 개체 타입.  자신의 기본키만으로 식별이 어려우므로 상위의 강한 개체 타입의 기본키를 상속받아 사용한다. 상위 개체 타입의 키와 결합하여 약한 개체 타입의 개별 개체를 고유하게 식별하는 속성을 식별자discriminator 혹은 부분키partial key 라고 한다.

## 5 IE 표기법

ER 모델 표기법은 지금까지 살펴본 표기법 외에도 여러 표기법이 존재한다. 대표적으로 IE 표기법Information Engineering Notation과 바커 표기법Baker Notation이 있다. IE 표기법은 관계 대응 수를 새발 모양의 기호로 표현하여 새발 표기법crow-feet 이라고도 부른다. IE 표기법에서 개체 타입과 속성은 직사각형으로 표현한다. 관계는 마름모꼴 대신 개체 타입
인 직사각형을 관계 실선으로 연결하고 기호를 이용하여 관계 대응 수 등을 표현한다. 관계 실선에서 개체 쪽의 기호는 반대쪽 개체의 최대참여 (1 혹은 N)를 나타내며, '', ' ' 기호는 최소참여(참여 제약 조건)로 선택참여(○) 혹은 필수참여(|) 나타낸다.

# 03 ER 모델을 관계 데이터 모델로 사상

완성된 ER 모델은 실제 데이터베이스로 구축하기 위해 논리적 모델링 단계를 거치는데, 이 단계에서 사상mapping이 이루어진다.

## 1 개체 타입의 사상

[1단계] 강한(정규) 개체 타입
정규 개체 타입 E의 경우 대응하는 릴레이션 R을 생성한다. 각 개체 타입의 일반 속성은 각각 새
로 생성하는 릴레이션의 속성으로 표시하고, 기본키와 외래키는 PK나 FK 등으로 표시한다.

[2단계] 약한 개체 타입
약한 개체 타입에서 생성된 릴레이션은 자신의 키와 함께 강한 개체 타입의 키를 외래키로 사상하여 자신의 기본키를 구성한다. 이때 유도된 속성이나 복합 속성 등은 속성의 성격에 맞게 판단하여 사상한다.

## 2 관계 타입의 사상

관계 타입은 각 관계 타입이 맺고 있는 차수와 관계 대응 수에 따라 사상 방식을 구분할 수 있다. 이진 관계 타입 R을 사상하는 방법에는 다음과 같이 네 가지가 있다.

[방법 1] 오른쪽 개체 타입 E2를 기준으로 관계 R을 표현한다.

[방법 2] 왼쪽 개체 타입 E1을 기준으로 관계 R을 표현한다.

[방법 3] 단일 릴레이션 ER로 모두 통합하여 관계 R을 표현한다.

[방법 4] 개체 타입 E1.E2와 관계 타입 R을 모두 독립된 릴레이션으로 표현한다.

[3단계] 이진 1:1 관계 타입

[방법 1]~[방법 41까지 모든 유형으로 사상할 수 있다.

[4단계] 이진 1:N 관계 타입

N의 위치에 따라 [방법 1] 또는 [방법 2]의 유형으로 사상된다.

[5단계] 이진 M:N 관계 타입

[방법 4]의 유형으로 사상된다. 양쪽 모두 다수의 대응 수를 가지므로새로운 릴레이션을 반드시 생성해야 한다. 새로운 릴레이션은 교차 테이블이라고 한다.

[6단계] N진 관계 타입

[방법 4]의 유형으로 사상된다. 그리고 생성되는 릴레이션 R의 키는 각 개체 타입의 기본키를 모은 복합키를 사용한다.

## 3 다중값 속성의 사상

다중값 속성의 경우 직접 사상할 수 없다. 다중값 속성은 취미가 (등산, 스키, 노래)인 것과 같이 하나의 속성에 여러 값을 가질 수 있는 속성을 말한다. 다중값 속성을 가진 ER 모델을 관계 데이터 모델로 사상하는 방법에는 다음과 같이 두 가지가 있다.

[방법 1] C 값의 수를 알 수 없는 경우

[방법 2] C 값의 수가 세 개 이하일 경우

[7단계] 다중값 속성
속성의 개수를 알수 없는 경우 [방법 1], 속성의 개수가 제한적으로 정해지는 경우 [방법 2]를 사용한다.

[방법 1]은 새로 생성된 릴레이션 RC에 값이 계속 저장될 수 있어 [방법 2]보다 효율적이다. 그러나 새로운 릴레이션이 생기게 되어 모델이 복잡해질 수 있다.

# 04 ERwin 실습

데이터 모델링을 하기 위한 프로그램으로는 ERwin과 ER STUDIO, DA# 등이 있는데, ERwin이 가장 많이 사용된다. ERwin은 개념적 모델링을 별도로 지원하지 않고 직접 논리적 모델링을 진행한다는 점이다.

## 1 ERwin 기본 화면 및 툴 둘러보기

기본 화면 : 메뉴, 툴바, 다이어그램 작성 영역, 모델 탐색기

눌 박스 : 개체, SUB 타입, 1:N(식별), M:N(식별), 1:N(비식별)

## 2 ERwin 실습을 위한 기본 환경 설정하기

1. 모델 타입, DBMS 선택하기
2. IE 표기법으로 변경하기
3. 툴바에 메뉴 추가하기(선택사항)

## 3 마당서점 설계 실습

### 마당서점의 논리적 모델링

- 개체 만들기
- 관계 표현하기
- MIN 관계 해소하기
- 식별 관계 및 관계 대응 수 변경하기

### 도메인 정의하기

도메인이란 속성이 가질 수 있는 값을 뜻한다.

### 마당서점의 물리적 모델링

1. ER 다이어그램 불러오기
2. Physical 타입으로 변경하기
3. 물리적 모델링
4. 컬럼의 속성 확인하기

## 4 DBMS에 접속하여 테이블 생성하기

1. DBMS에 접속하기
2. 테이블 생성하기

# 05 모델링 연습(마당대학 데이터베이스)

(교재의 그림 참조)