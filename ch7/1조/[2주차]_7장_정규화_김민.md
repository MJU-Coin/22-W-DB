# Chapter 07 정규화

# 01 이상현상

이상현상anomaly 이란 테이블에 투플을 삽입할 때 부득이하게 NULL 값이 입력되거나 삭제 시 연쇄삭제 현상이 발생하거나, 수정 시 데이터의 일관성이 훼손되는 현상을 말한다.

## 1 이상현상의 개념

- 삭제이상 : 란 투플 삭제 시 같이 저장된 다른 정보까지 연쇄적으로 삭제되는 현상
- 삽입이상 : 투플 삽입 시 특정 속성에 해당하는 값이 없어 NULL 값을 입력해야 하는 현상
- 수정 이상 : 투플수정 시 중복된 데이터의 일부만 수정되어 데이터의 불일치 문제가 일어나는 현상

# 02 함수 종속성

## 1 함수 종속성의 개념

이상현상이 발생하는 테이블을 수정하여 정상으로 만드는 과정을 정규화normalization 라고 한다. 정규화를 하기 위해서는 먼저 테이블을 분석하여 기본키와 함수 종속성을 파악해야 한다.

어떤 속성 A 의 값을 알면 다른 속성 B의 값이 유일하게 정해지는 의존 관계를 '속성 B는 속성 A에 종속한다dependen' 혹은 '속성 A는 속성 B를 결정한다deternine'라고 한다. 이 관계를 'A → B'로 표기하며, A는 B의 결정자라고 한다.

왼쪽 속성의 모든 값에 대하여 오른쪽 속성의 값이 유일하게 결정될 때 함수적으로 종속한다functionally dependent'라고 한다. 릴레이션의 속성 간에 함수적으로 종속하는 성질을 함수 종속성FD, functional dependency' 혹은 원어를 모두 해석하여 '함수적 종속성'이라고 한다

## 2 함수 종속성의 다이어그램

함수 종속성 다이어그램은 릴레이션의 속성을 직사각형, 속성 간의 함수 종속성을 화살표로 나타낸다. 복합 속성의 경우 직사각형으로 묶어서 그린다.

## 3 함수 종속성 규칙

릴레이션에는 당연히 성립하는 종속관계가 있다. 'X→X'와 같은 자기 자신에 대한 것이다. 또 릴레이션에 존재하는 모든 종속관계의 집합 {X→ Y, .……}을 구하면 이 집합으로부터 유
도할 수 있는 종속관계가 있다.

### 함수 종속성 규칙 (functional dependency rule)

X,Y,Z가 릴레이션 R에 포함된 속성의 집합이라고 할 때 함수 종속성에 관한 다음과 같은 규칙이 성립한다.

- 부분집합 규칙
- 증가 규칙
- 이행 규칙

위 세 가지 규칙으로부터 부가적으로 다음의 규칙을 얻을 수 있다.

- 결합 규칙
- 분해 규칙
- 유사이행 규칙

## 4 함수 종속성과 기본키

릴레이션의 함수 종속성을 파악하기 위해서는 우선 기본키를 찾아야 한다. 기본키가 함수 종속성에서 어떤 역할을 하는지 알면 이상현상을 제거하는 정규화 과정을 쉽게 이해할 수 있다.

## 5 이상현상과 결정자

이상현상은 한 개의 릴레이션에 두 개 이상의 정보가 포함되어 있을 때 나타난다.

# 03 정규화

이상현상의 원인은 여러 가지가 있는데, 대부분 두 가지 이상의 정보가 한 릴레이션에 저장되어 있기 때문에 발생한다. 따라서 이상현상은 릴레이션을 분해하여 제거한다. 분해된 릴레이션에 이상현상이 남아 있다면 이상현상이 없어질 때까지 분해한다. 이상현상이 발생하는 릴레이션을 분해하여 이상현상을 없애는 과정을 정규화normalization 라고 한다.

## 1 정규화 과정

이상현상이 있는 릴레이션은 이상현상을 일으키는 함수 종속성의 유형에 따라 등급을 구분할 수 있다. 릴레이션은 정규형이라는 개념으로 구분한다. 정규형이 높을수록 이상현상은 줄어든다.

### 제 1 정규형

릴레이션 R의 모든 속성 값이 원자값을 가지면 제 1 정규형이라고 한다.

관계 데이터베이스에서 릴레이션의 속성 값은 반드시 원자값이어야 한다.

### 제 2정규형

릴레이션 R이 제 1정규형이고 기본키가 아닌 속성이 기본키에 완전함수 종속일 때 제 2정규형이라고 한다

- 완전 함수 종속ultunctional dependency이란?

A와 B가 릴레이션 R의 속성이고 A→B 종속성이 성립할 때 B가 A의 속성 전체에 함수 종속하고 부분집합 속성에 함수 종속하지 않을 경우이다.

- 불완전 함수 종속 혹은 부분 함수 종속partial functional dependency이란?

A → B 종속성에서 A의 속성 일부를 제거해도 종속성이 여전히 성립하는 경우이다.

### 제 3정규형

릴레이션 R이 제 2 정규형이고 기본키가 아닌 속성이 기본키에 비이행적hon-transe으로 종속할 때(직접 종속) 제3정규형이라고 한다. 이행적 종속이란 A→B.B→C가 성립할 때 A→C가 성립되는 함수 종속성을 말한다.

### BCNF 정규형

릴레이션 R에서 함수 종속성 X- Y가 성립할 때 모든 결정자가 후보이면 BCNF 정규형이라고 한다.

## 2 무손실 분해

정규화는 릴레이션을 분해하여 이상현상을 제거하는 과정이다. 분해된 릴레이션 간의 관계relationship를 유지하기 위해 분해된 릴레이션에 공통속성을 한 개 이상 두어야 한다. 공통속성은 분해된 릴레이션을 다시 원래의 릴레이션으로 합성(조인)할 때 사용한다. 어떤 속성을 공통속성으로 해야 하는지 다음의 무손실 분해 규칙을 통해 알아보자.

### 무손실 분해

릴레이션 R을 릴레이션 R1 과 R2로 분해할 때, R1**[⋈](https://unicode-table.com/kr/22C8/#:~:text=%E2%8B%88%20%2D%20%EB%82%98%EB%B9%84%20%EB%84%A5%ED%83%80%EC%9D%B4%3A%20U%2B,%EC%9C%A0%EB%8B%88%20%EC%BD%94%EB%93%9C%20%EB%AC%B8%EC%9E%90%20%EB%B0%B1%EA%B3%BC%20%EC%82%AC%EC%A0%84)**R2=R이면 무손실 분해라고 한다. 무손실 분해를 위한 조건은 R1∩R2→R1이나 R1∩R2→R2 중 하나를 만족해야 한다.

## 3 정규화 정리

정규형은 정규화되거나 되지 않은 모든 릴레이션부터 제 1 정규형, 제 2 정규형, 제 3 정규형, BCNF, 제 4 정규형, 제 5 정규형까지 존재한다. 제 4 정규형은 다치종속성 multivalued dependency을 가진 릴레이션에 관한 내용이며, 제 5 정규형은 프로젝트-조인 정규형 project-join normal form. PJINN이라고 부르며 조인종속성 join dependency을 가진 릴레이션에 관한 내용이다. 대부분의 릴레이션은 BCNF까지 정규화하면 실제적인 이상현상은 없어진다. 따라서 보통 BCNF까지 정규화를 진행한다.

정규화는 릴레이션의 분해를 통해 이루어지는데, 분해 과정에서 주목할 점이 있다. 즉 어떤정규형 상태인 릴레이션 R1을 분해하여 만든 R2, R3 릴레이션은 R1 다음 정규형이 아닌 더 높은 정규형이 될 수 있다는 점이다.